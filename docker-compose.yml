version: '3.8'

services:
  rockdb-backend:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: rockdb_app
    ports:
      - "8080:8080"
      - "9100:9100"
    volumes:
      # Persistent storage for the SQLite database
      - rockdb_data:/opt/rockdbweb
      # Persistence for SQL scripts (mapped to local folder to allow easy editing)
      - ./sql:/app/sql
    environment:
      - ROCKDB_DATA_DIR=/opt/rockdbweb
      - ROCKDB_SCRIPTS_DIR=/app/sql
      - ENCRYPTION_KEY=${ENCRYPTION_KEY:-rockdb_secret_key}
    restart: always

volumes:
  rockdb_data:
    driver: local
